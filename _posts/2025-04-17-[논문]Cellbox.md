---
title: >-
  [논문] CellBox
author: csm
date: 2025-04-17 14:10:00 +0900
categories: [Biology, System dynamics]
tags: [paper]
description: >-
    CellBox: Interpretable Machine Learning for Perturbation Biology with Application to the Design of Cancer Combination Therapy
math: true
---

[CellBox: Interpretable Machine Learning for Perturbation Biology with Application to the Design of Cancer Combination Therapy](https://doi.org/10.1016/j.cels.2020.11.013)

## Highlights
---
- CellBox:
  - 세포 내 역학에 대한 명시적 모델을 포함하는 머신러닝 프레임워크
  - 이전에 관찰되지 않은 자극(perturbation)에 대한 시스템 반응 예측
  - CellBox에서 유도된 분자 상호작용은 일반적으로 알려진 생물학적 경로와 일치
  - 세포 생물학에서 해석 가능한 과학적 머신러닝의 한 예시

## Summary
---
- (배경)세포에 대한 체계적인 perturbation 후, 분자적, 표현형 반응을 측정하는 것은 세포 생물학의 계산 모델을 구축하는 데 유용한 데이터 자원 제공
  - perturbation: 세포, 유전자 또는 시스템의 정상적인 상태를 인위적으로 변화시키는 것. 약물 처리, 유전자 조작, 환경 변화 등
- (목표)일반화 된 모델 ⟶ 새로운 perturbation 조건에서도 세포 반응 정확하게 예측 ⟶ 새로운 치료법 개발에 활용
- (문제)대규모 생물학적 데이터 세트에 대한 머신 러닝의 주요 과제: 복잡한 다차원 공간에서 global optima를 찾고 솔루션을 메커니즘적으로 해석하는 것 / 모델의 예측 결과를 생물학적으로 의미있게 해석하는 것
  - global optima를 찾는 다는 것은 모델이 가장 정확한 예측을 할 수 있는 최적의 파라미터 값을 찾는 것
- (접근 방식)세포 역학의 명시적 수학적 모델과 TensorFlow에서 구현된 machine-learning framework를 결합한 하이브리드 접근 방식 도입
  - 흑색종 세포주에 대한 약물 치료 후의 perturbation 반응 데이터셋에서 모델링 프레임워크를 테스트
- (결과)사전 지식과 독립적임에도 불구하고 *de novo* 네트워크 모델은 일부 알려진 상호작용 재현
  - *de novo* 네트워크 모델: 사전 지식 없이 데이터로부터 새롭게 학습된 네트워크 모델

- (요약)이 연구는 세포에 대한 다양한 perturbation에 따른 반응 데이터를 이용해 세포의 행동을 예측하는 계산 모델을 개발, 이를 통해 새로운 치료법 개발에 기여. 특히 기존 머신 러닝 모델의 해석 가능성 부족 문제를 해결하기 위해 수학 모델과 머신 러닝을 결합한 하이브리드 접근 방식 사용

## Graphical Abstract
---

<img src="assets/img/post/cellbox_graphical_abstract.webp" alt="1" width="100%" height="100%"/> 

## keywords
---
- perturbation biology
- machine learning
- interpretability
- cell dynamics
- systems biology
- dynamical systems
- combinatorial therapy
- network pharmacology
- cancer

## Introduction
---
- 암 치료에서 단일 약제 내성 문제: 단일 항암제를 사용하는 경우 내성이 발생하는 문제 ⟶ Combination therapy
- 병용 용법: 여러 약제를 함께 사용하면 암 치료에 효과적. 모든 약물 조합을 실험적으로 스크리닝(선별하는 과정)하는 것은 현실적으로 어려움
  - 후보 약제 조합을 시험하기 위해 세포의 반응을 기반으로 하는 계산 모델 사용되고 있지만, 모델의 범위 제한적
- 새로운 조합 치료의 후보를 탐색하는 과정이 보다 효율적으로 이루어질 필요성

## Perturbation-Response Profiling in Cell Biology
---
- 세포가 perturbation에 어떻게 반응하는지 이해하기 위해 여러 실험적 접근법 사용
  - 주로 생화학적 및 세포학적 실험 사용, 특정 단백질-단백질 쌍 간의 관계를 조사하는 데 효과적
  - 개별적인 섭동 실험은 작업이 번거롭고, 만들어진 모델은 통찰력을 제공할 수 있지만 세부적인 분자적 또는 시스템 수준의 반응을 정량적으로 예측하는 데에 한계
- Phenotypic screening(표현형 기반 스크리닝): 세포 전체의 반응에 대한 정보를 수집하기 위해 세포 생존율이나 성장 속도와 같은 단일 변수 사용.
  - Phenotypic Indicators: 세포 생존률, 분열률, 사멸률. 세포 크기, 형태 변화
- 풍부한 데이터셋 ⟶ 세포 반응 모델링, 넓은 맥락에서 원인 추론 ⟶ 기전 가설을 검증할 실험을 설계하거나 조합 치료 후보 물질을 탐색하는 데 중요

## Computational Modeling
---
- 세포 간 상호작용을 추론하고 세포 반응을 예측하기 위한 다양한 계산 방법
- 정적(static) 모델: co-expression models, maximum entropy networks, mutual information 기반의 방법들을 사용하여 분자 간 상호자굥 네트워크 모델을 구축하거나 perturbation에 따른 반응 데이터를 바탕으로 세포 반응을 직접 예측한느 regression 모델 활용
- 동적(dynamic) 모델: 시간이 흐름에 따라 세포 신호가 표현형 반응으로 전달되는 과정을 기전적으로(mechanistically)설명. Boolean network models, fuzzy logic models, dynamic Bayesian networks, ODE network models 포함. 이러한 모델은 상호작용 파라미터에 대한 사전 지식이 필요하기에 일반적으로 작은 규모의 시스템에서 활용
- 대규모 기전 모델(mechanistic models)
  - 관련 상호작용들에 대한 사전 지식이 필요하지만, 존재하지 않거나 일관된 맥락이 부족하다는 제약
  - 엄밀한 접근 방식으로는 하나의 실험 조건에서 체계적인 방식으로 생성된 균일한 데이터셋 활용, 그 맥락에 특화퇸 상호작용 네트워크의 구조를 *de novo*(처음부터) 추론
  - dynamic optimization 접근 방식의 한계
    - 몬테카를로(MC) 방법: 대규모 시스템에 잘 확장되지 못할 수 있음
    - belief-propagation(BP) algorithms: 효율적인 탐색을 위해 과도한 수학적 근사를 요구할 수 있음
- ⟹ 대규모 시스템에 대해 정확한 파라미터 추론을 가능하게 하고, 복잡한 동역학 모델로 일반화하기 위해, 일반적인 데이터 기반 모델링 프레임워크 필요

## Machine Learning and Interpretability
---
- 딥러닝 ⟶ 데이터 기반 프레임워크
  - gradient descent, automatic differentiation
  - 효율적인 파라미터 최적화
  - interpretation(이해 가능한 해석)에서의 한계: 'black box' problem
- 연구에서는 black-box neural network 대신 세포 구성요소 간의 명시적으로 해석 가능한 상호작용 네트워크를 포함하는 데이터 기반 모델인 'CellBox' 개발. 딥러닝 최적화 방식을 적용하면서도 높은 학습 성능을 유지하는 것이 목표 (cellbox라는 네이밍은 딥러닝 모델의 blackbox라는 단어에서 착안한 듯함)
- CellBox: 세포 반응 계산 모델링 프레임워크
  1. perturbation과 phenotypic changes를 하나의 통합된 계산 모델로 연결
  2. dynamical 세포 반응의 정량화
  3. 대규모 시스템에 대한 학습 효율성과 확장성
  4. 신호전달 경로 등 기존 분자생물학 모델과 비교 가능한 해석 가능성(interpretable interactions)
- CellBox는 99개의 생물학적 구성요소(단백질, 전사인자 활성도, 표현형 지표, 분자간 상호작용의 노드 등)로 구성된 비선형 ODE 기반 모델을 구축하여 perturbation, 단백질 반응, 표현형 간의 연결을 통해 세포의 동적 행동 시뮬레이션. 네트워크의 연결 구조는 89개의 실험 조건(perturbation type, single or combinatorial perturbations, cell line, measured outputs 등) 하에서의 post-perturbational data로부터 직접 학습되며, 훈련 데이터의 분자 및 세포 반응을 정확히 재현하는 것이 목적 ⟶ gradient descent를 사용하여 ODE 네트워크 내 상호작용 파라미터를 추론 ⟶ 새로운 교란 조건에서도 세포 행동을 예츨할 수 있도록 모델 훈련
- 데이터 기반 모델의 핵심 성능 기준은 소수의 실험으로 학습한 상태에서도, 이전에 보지 못한 다양한 교란 조건에 대해 합리적인 정확도의 예측을 제공할 수 있는가 ⟶ CellBox를 광범위한 동적 세포 활동을 모델링할 수 있는 범용적인 프레임워크로 제안

## Results
---
### CellBox Model of Perturbation Biology

- perturbation 데이터의 조건
  1. 특정 perturbation 조건들에 대해 단백질 수준의 변화와 세포 행동의 변화를 짝지어 측정한 데이터 존재
  2. training data와 withheld data(검증용 또는 보류 데이터) 구분
- 89개의 perturbation 조건에 각각에 대해 cell lysates 내 82개의 선택된 단백질 및 인산화 단백질(phosphoprotein)의 수준이 perturbation 전과 perturbation 후 24시간 시점에서 antibody-based Reverse Phase Protein Arrays(RPPA) 기법으로 측정 ⟶ 세포 내 신호 네트워크의 입력 및 중간 반응 지표로 활용. 각 perturbation 조건에서 단백질/인산화 단백질 정량화 ⟶ 세포 반응을 동적으로 학습할 수 있는 분자 데이터
  - RPPA 기법: 단백질 수준에서 다수의 샘플을 동시에 high-throughput 방식으로 분석할 수 있는 항체 기반 기술. 세포 내 신호전달 경로, 단백질 발현량, 인산화 상태 등을 정량화. 기존 단백질 microarray와 유사하지만 샘플이 고정된 고체 표면에 직접 도포됨. 세포 또는 조직에서 단백질을 추출해 만든 세포 용해물(lysate)이 샘플.
- phenotype 분석: cell cycle progression, cell viability
- ⟹ 분자 수준(단백질)과 세포 수준(표현형)의 반응을 동일한 교란 조건 하에서 병렬적으로 측정, 해당 데이터셋은 분자 변화와 세포 반응을 정량적으로 연결할 수 있는 네트워크 모델 구축을 위한 정보 제공

- Figure 1
  <img src="assets/img/post/cellbox_figure1.webp" alt="1" width="100%" height="100%"/> 
  - CellBox: 교란 데이터를 활용한 세포 시스템의 동적
  - (A): perturbation 및 반응 측정
    - drug와 같은 perturbation을 통해 세포 시스템에 변화 유도. 세포 반응은 두 가지 수준에서 측정
      - 분자 수준: 단백질 및 인산화 단백질의 발현량 변화
      - 세포 표현형 수준: 세포 생존률, 세포 주기 등
  - (B): CellBox 모델 구축 및 예측
    - 반응 데이터를 이용해 interpretable한 머신러닝 모델 CellBox 구축
    - 단백질/인산화 단백질과 세포 표현형 변수 사이의 상호작용을 ODE 집합으로 표현
    - interaction parameters를 최적화하며 학습 ⟶ 목표: 수치적으로 시뮬레이션된 시스템 반응이 실험에서 관측된 반응과 잘 맞도록 하는 것
    - 학습 후 CellBox는 기존의 pairwise perturbation-response data을 바탕으로 학습한 모델 활용, 새로운 perturbation 조건에 대한 세포 반응 예측

- drug perturbations에 대한 세포 시스템의 동적 반응을 모델링하기 위해, nonlinear envelope이 포함된 ODE 집합 사용
- ODE 모델의 핵심 구성 요소
  - 상호작용 파라미터 $$w_{ij}$$
    - 네트워크 내 각 생물학적 구성요소들($$i$$, $$j$$) 사이의 상호작용 강도
    - 전체 모델에서 약 10,000개의 파라미터 존재
  - 상호작용 구조는 단순한 형태에 비선형 함수 $$\varphi$$가 적용되어 복잡한 세포 반응 표현
  - restoration term(복원 항): $$-\alpha_{i}x_{i}(t)$$
    - 시간에 따라 자연적으로 상태가 감소하는 decay를 반영(해당 단백질의 활성 상태가 외부 자극 없이 점점 줄어드는 것. 탈인산화(dephosphorylation), 단백질 분해(proteolysis), 회복 메커니즘(homeostasis) 등)
  - ⟹ 구성요소는 계산적으로 mean-field 접근법과 유사하게 작용. 데이터가 전체 세포 구성요서의 일부만을 포함하는 현실적인 제약에서, 모델의 불안정성을 방지하기 위해 도입된 장치
- 학습 과정
  - 초기화 및 최적화
    - $$w_{ij}$$는 random initialization
    - 모델 학습 중 반복적으로 업데이트하며 loss function 최소화
  - 손실 함수의 정의(STAR Methods의 Equation 3 참고)
    - 실험 데이터와 모델 예측 간의 유클리드 거리
    - 네트워크 밀도에 대한 L1 정규화 항(과적합 방지)
- 수치 해법 및 최적화 기법
  - ODE 시스템의 수치적 해법에는 Heun's method 사용
    - Heun's method: 2차 정확도의 Euler method
  - 모델 최적화는 Adam optimizer 활용

### CellBox Can Be Trained on Perturbation Data to Predict Cell Response Accurately
- CellBox 모델 학습 방식의 예측 성능을 평가
  - 전체 perturbation 데이터의 70%(62개 조건): training set
  - 30%(27개 조건): test set
  - 20%: validation set
- hyperparameters 최적화
  - 학습률(learning rate)
  - 정규화 항(regularization)
  - ODE simulation time
- ODE 시스템의 수치 해법 결과는 실험 데이터에 매우 근접하도록 수렴(convergence)
- 이러한 모델링 절차는 무작위로 perturbation 데이터를 분할한 총 1,000개의 경우에 대해 독립적으로 반복, 각 경우마다 개별 CellBox 모델 학습 ⟶ 평균 예측값은 실험 데이터와 높은 상관관계. Pearson's correlation coefficient: 0.93(Figure 2C 참고)
- 개별 perturbation 조건에 대한 세부 분석에서는 모델이 모든 조건에서 고르게 잘 학습(Figure 2D 참고)
- 단백질 프로파일링 데이터에 일반적으로 적용되는 스케일링 여부와 모델 성능은 무관

- Figure 2
  <img src="assets/img/post/cellbox_figure2.webp" alt="1" width="100%" height="100%"/> 
  - CellBox의 수렴 및 무작위 학습-테스트 분할에 대한 예측 정확도
  - (A): 학습 과정 동안의 손실 감소 및 모델 수렴
    - training set(56%), validation set(14%), test set(30%)에 대해 mse가 거의 단조롭게 감소 ⟶ 모델은 학습 종료 시점에서 효율적으로 수렴(convergence)
  - (B): 예측 반응 vs 실험 결과 (steady state)
    - 학습된 ODE 모델은 drug perturbation 이후 steady state 에서 분자 및 표현형 반응 예측 ⟶ 예측값은 실험 결과와 잘 일치
    - 그림에는 일부 분자 측정값과 표현형 측정값을 예시로 제시
      - 분자(단백질/인산화 단백질): MAPKpT202, YB1pS102, MEKpS217, p27
      - 표현형: G2/M phase 비율, G1 arrest
    - 세포 반응(cell response) 정의: $$log_{2}(\frac{post-perturbation}{pre-perturbation})$$
  - (C): 전체 모델 평균 예측 정확도
    - 서로 다른 데이터 분할로 학습된 1,000개의 CellBox 모델에 대해, 모든 교란 조건과 모든 분자/표현형 측정값에 대해 예측값과 실험값 간의 상관관계 분석
    - 피어슨 상관 계수: $$\rho$$ = 0.926
    - 회귀선은 dark blue로 표시, 95% 신뢰구간 포함
    - 하나의 점은 하나의 측정값(분자 또는 표현형)
  - (D): 개별 교란 조건별 예측 정확도
    - 개별 교란 조건 각각에 대해 모델이 예측한 값은 실험 측정값과 높은 상관관계
    - CellBox는 특정 조건에 대한 바응도 정확하게 예측할 수 있음을 보임

